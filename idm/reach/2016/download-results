#!/bin/bash

dl() {
  local sample=$1
  local stage=$2
  local dest=$3
  rsync \
    -avmu \
    slac.sdf:/sdf/group/hps/users/eichl008/hps/idm/reach/2016/${sample}/output/${stage}/ ${dest%/}
  return $?
}

help() {
  cat <<\HELP

  Download hpstr ana output for a given sample to this computer.

 USAGE: 

    ./download-results SAMPLE STAGE [DEST]

 ARGUMENTS:
  SAMPLE  : name of detector to download results from
            /sdf/group/hps/users/eichl008/hps/idm/reach/2016/
  STAGE   : name of stage of output to copy down
            e.g. 'ana', 'recon', or 'sim'
  DEST    : optional name of destination directory
            defaults to directory named SAMPLE

HELP
}

if [ "$#" -lt 2 ] || [ $# -gt 3 ] || [ "$1" = "help" ]; then
  help
  exit 0
fi

dl $1 ${2} ${3:-${1}/${2}}
